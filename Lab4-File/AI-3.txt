AI æå• ä¾‹3, Copilot:
çµ¦æˆ‘ C# .Net 8.0 çš„ç¨‹å¼, åŒ…å«ImportCSV(), ExportCSV()å‡½æ•¸, ç¶“ç”±ä»¥ä¸‹ class CRecord, MySql çš„ table tlab3, ä»¥ CSV çš„æ ¼å¼, é€—è™Ÿåˆ†éš”æ¬„ä½, åŒ¯å…¥æˆ–åŒ¯å‡º MySql çš„ table tlab3 çš„è³‡æ–™, ç‚º UTF8 æ–‡å­—æª”æ¡ˆ.  

CREATE TABLE `tlab3` (
  `fpk1` int NOT NULL,
  `fsku` varchar(16) NOT NULL,
  `fname` varchar(64) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci DEFAULT NULL,
  `fprice` decimal(13,2) NOT NULL,
  `fqty` int NOT NULL,
  `famount` decimal(13,2) NOT NULL,
  `fcreate_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `fupdate_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`fpk1`)
  UNIQUE KEY `fpk1_UNIQUE` (`fpk1`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

public class CRecord
{
	public int PK1  = 0;
	public string SKU = string.Empty;
	public string? Name = null;
	public decimal Price = 0;
	public int Qty = 0;
	public decimal Amount = 0;
	public DateTime CreateTime = DateTime.MinValue;
	public DateTime LastUpdateTime = DateTime.MinValue;
}

ä»¥ä¸‹æ˜¯ C# .NET 8.0 çš„ç¨‹å¼ç¢¼ï¼ŒåŒ…å«åŒ¯å…¥ (`ImportCSV`) å’ŒåŒ¯å‡º (`ExportCSV`) CSV çš„å‡½æ•¸ï¼Œä½¿ç”¨ `CRecord` å­˜å– MySQL çš„ `tlab3` è¡¨æ ¼ï¼š

### **ç¨‹å¼ç¢¼**

```csharp
using System;
using System.Collections.Generic;
using System.IO;
using MySql.Data.MySqlClient;

public class DatabaseHandler
{
    private string connectionString = "Server=localhost;Database=your_database;User ID=your_user;Password=your_password;";

    // åŒ¯å‡º CSV
    public void ExportCSV(string filePath)
    {
        string query = "SELECT * FROM tlab3";
        using var connection = new MySqlConnection(connectionString);
        using var command = new MySqlCommand(query, connection);
        connection.Open();
        using var reader = command.ExecuteReader();
        using var writer = new StreamWriter(filePath, false, System.Text.Encoding.UTF8);
        writer.WriteLine("PK1,SKU,Name,Price,Qty,Amount,CreateTime,LastUpdateTime"); // CSV æ¨™é ­
        while (reader.Read())
        {
            writer.WriteLine($"{reader["fpk1"]},{reader["fsku"]},{reader["fname"]},{reader["fprice"]},{reader["fqty"]},{reader["famount"]},{reader["fcreate_time"]},{reader["fupdate_time"]}");
        }
    }

    // åŒ¯å…¥ CSV
    public void ImportCSV(string filePath)
    {
        using var connection = new MySqlConnection(connectionString);
        connection.Open();
        using var transaction = connection.BeginTransaction();

        try
        {
            using var reader = new StreamReader(filePath, System.Text.Encoding.UTF8);
            string line;
            reader.ReadLine(); // ç•¥éæ¨™é ­
            while ((line = reader.ReadLine()) != null)
            {
                var values = line.Split(',');
                string query = @"INSERT INTO tlab3 (fpk1, fsku, fname, fprice, fqty, famount, fcreate_time, fupdate_time) 
                                VALUES (@PK1, @SKU, @Name, @Price, @Qty, @Amount, @CreateTime, @LastUpdateTime) 
                                ON DUPLICATE KEY UPDATE 
                                fsku = @SKU, fname = @Name, fprice = @Price, fqty = @Qty, famount = @Amount, 
                                fcreate_time = @CreateTime, fupdate_time = @LastUpdateTime";
                using var command = new MySqlCommand(query, connection, transaction);
                command.Parameters.AddWithValue("@PK1", int.Parse(values[0]));
                command.Parameters.AddWithValue("@SKU", values[1]);
                command.Parameters.AddWithValue("@Name", string.IsNullOrEmpty(values[2]) ? (object)DBNull.Value : values[2]);
                command.Parameters.AddWithValue("@Price", decimal.Parse(values[3]));
                command.Parameters.AddWithValue("@Qty", int.Parse(values[4]));
                command.Parameters.AddWithValue("@Amount", decimal.Parse(values[5]));
                command.Parameters.AddWithValue("@CreateTime", DateTime.Parse(values[6]));
                command.Parameters.AddWithValue("@LastUpdateTime", DateTime.Parse(values[7]));
                command.ExecuteNonQuery();
            }
            transaction.Commit();
        }
        catch (Exception ex)
        {
            transaction.Rollback();
            throw new Exception("åŒ¯å…¥å¤±æ•—: " + ex.Message);
        }
    }
}

public class Program
{
    public static void Main()
    {
        var dbHandler = new DatabaseHandler();

        // åŒ¯å‡º CSV
        dbHandler.ExportCSV("tlab3_export.csv");
        Console.WriteLine("è³‡æ–™å·²åŒ¯å‡ºè‡³ tlab3_export.csv");

        // åŒ¯å…¥ CSV
        dbHandler.ImportCSV("tlab3_import.csv");
        Console.WriteLine("è³‡æ–™å·²æˆåŠŸåŒ¯å…¥");
    }
}
```

### **ç¨‹å¼èªªæ˜**
1. **`ExportCSV` å‡½æ•¸**ï¼š
   - å¾ `tlab3` è¡¨æ ¼è®€å–è³‡æ–™ï¼Œä¸¦å°‡å…¶åŒ¯å‡ºåˆ°æŒ‡å®šçš„ CSV æª”æ¡ˆã€‚
   - ä½¿ç”¨ `StreamWriter` å¯«å…¥ UTF-8 æ ¼å¼ã€‚

2. **`ImportCSV` å‡½æ•¸**ï¼š
   - å¾ CSV æª”æ¡ˆè®€å–è³‡æ–™ï¼Œä¸¦æ’å…¥æˆ–æ›´æ–°åˆ° `tlab3` è¡¨æ ¼ã€‚
   - ä½¿ç”¨ `ON DUPLICATE KEY UPDATE` ç¢ºä¿ä¸»éµé‡è¤‡æ™‚é€²è¡Œæ›´æ–°ã€‚

3. **ä¾‹å¤–è™•ç†**ï¼š
   - åŒ¯å…¥éç¨‹ä¸­ä½¿ç”¨äº¤æ˜“ (`Transaction`) ä»¥ç¢ºä¿æ“ä½œçš„å®Œæ•´æ€§ï¼Œè‹¥ç™¼ç”ŸéŒ¯èª¤å‰‡å›æ»¾ã€‚

4. **CSV æ ¼å¼**ï¼š
   - ç¬¬ä¸€è¡Œç‚ºæ¬„ä½æ¨™é ­ï¼š`PK1,SKU,Name,Price,Qty,Amount,CreateTime,LastUpdateTime`ã€‚
   - å¾ŒçºŒæ¯è¡Œç‚ºè¡¨æ ¼ä¸­çš„ä¸€ç­†è³‡æ–™ã€‚

### **ä½¿ç”¨å»ºè­°**
- åœ¨ `connectionString` ä¸­å¡«å…¥æ­£ç¢ºçš„è³‡æ–™åº«é€£ç·šè³‡è¨Šã€‚
- ç¢ºä¿ CSV æ–‡ä»¶çš„æ ¼å¼å’Œå…§å®¹èˆ‡ `tlab3` è¡¨æ ¼çµæ§‹åŒ¹é…ã€‚

å¦‚æœæœ‰é€²ä¸€æ­¥çš„éœ€æ±‚æˆ–éœ€è¦å…¶ä»–åŠŸèƒ½æ“´å……ï¼Œéš¨æ™‚å‘Šè¨´æˆ‘ï¼ ğŸ˜Š