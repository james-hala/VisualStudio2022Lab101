AI æå• ä¾‹4, Copilot:
çµ¦æˆ‘ C# .Net 8.0 çš„ç¨‹å¼, åŒ…å«ImportJson(), ExportJson()å‡½æ•¸, ç¶“ç”±ä»¥ä¸‹ class CRecord, MySql çš„ table tlab3, ä»¥ Json çš„æ ¼å¼, åŒ¯å…¥æˆ–åŒ¯å‡º MySql çš„ table tlab3 çš„è³‡æ–™, ç‚º UTF8 æ–‡å­—æª”æ¡ˆ.  

CREATE TABLE `tlab3` (
  `fpk1` int NOT NULL,
  `fsku` varchar(16) NOT NULL,
  `fname` varchar(64) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci DEFAULT NULL,
  `fprice` decimal(13,2) NOT NULL,
  `fqty` int NOT NULL,
  `famount` decimal(13,2) NOT NULL,
  `fcreate_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `fupdate_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`fpk1`)
  UNIQUE KEY `fpk1_UNIQUE` (`fpk1`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

public class CRecord
{
	public int PK1  = 0;
	public string SKU = string.Empty;
	public string? Name = null;
	public decimal Price = 0;
	public int Qty = 0;
	public decimal Amount = 0;
	public DateTime CreateTime = DateTime.MinValue;
	public DateTime LastUpdateTime = DateTime.MinValue;
}

ä»¥ä¸‹æ˜¯ C# .NET 8.0 çš„ç¨‹å¼ç¢¼ï¼ŒåŒ…å« `ImportJson()` å’Œ `ExportJson()` å‡½æ•¸ï¼Œä»¥ JSON æ ¼å¼åŒ¯å…¥å’ŒåŒ¯å‡º MySQL çš„ `tlab3` è³‡æ–™ï¼Œä¸¦ä½¿ç”¨ UTF-8 æ–‡å­—æª”æ¡ˆï¼š

### **å®Œæ•´ç¨‹å¼ç¢¼**

```csharp
using System;
using System.Collections.Generic;
using System.IO;
using System.Text.Json;
using MySql.Data.MySqlClient;

public class DatabaseHandler
{
    private string connectionString = "Server=localhost;Database=your_database;User ID=your_user;Password=your_password;";

    // åŒ¯å‡º JSON
    public void ExportJson(string filePath)
    {
        string query = "SELECT * FROM tlab3";
        using var connection = new MySqlConnection(connectionString);
        using var command = new MySqlCommand(query, connection);
        connection.Open();
        using var reader = command.ExecuteReader();
        var records = new List<CRecord>();

        while (reader.Read())
        {
            records.Add(new CRecord
            {
                PK1 = reader.GetInt32("fpk1"),
                SKU = reader.GetString("fsku"),
                Name = reader.IsDBNull("fname") ? null : reader.GetString("fname"),
                Price = reader.GetDecimal("fprice"),
                Qty = reader.GetInt32("fqty"),
                Amount = reader.GetDecimal("famount"),
                CreateTime = reader.GetDateTime("fcreate_time"),
                LastUpdateTime = reader.GetDateTime("fupdate_time")
            });
        }

        var options = new JsonSerializerOptions { WriteIndented = true };
        string json = JsonSerializer.Serialize(records, options);

        File.WriteAllText(filePath, json, System.Text.Encoding.UTF8);
        Console.WriteLine("è³‡æ–™å·²åŒ¯å‡ºè‡³ JSON æª”æ¡ˆ");
    }

    // åŒ¯å…¥ JSON
    public void ImportJson(string filePath)
    {
        string json = File.ReadAllText(filePath, System.Text.Encoding.UTF8);
        var records = JsonSerializer.Deserialize<List<CRecord>>(json);

        using var connection = new MySqlConnection(connectionString);
        connection.Open();
        using var transaction = connection.BeginTransaction();

        try
        {
            foreach (var record in records)
            {
                string query = @"INSERT INTO tlab3 (fpk1, fsku, fname, fprice, fqty, famount, fcreate_time, fupdate_time) 
                                VALUES (@PK1, @SKU, @Name, @Price, @Qty, @Amount, @CreateTime, @LastUpdateTime) 
                                ON DUPLICATE KEY UPDATE 
                                fsku = @SKU, fname = @Name, fprice = @Price, fqty = @Qty, famount = @Amount, 
                                fcreate_time = @CreateTime, fupdate_time = @LastUpdateTime";
                using var command = new MySqlCommand(query, connection, transaction);
                command.Parameters.AddWithValue("@PK1", record.PK1);
                command.Parameters.AddWithValue("@SKU", record.SKU);
                command.Parameters.AddWithValue("@Name", record.Name ?? (object)DBNull.Value);
                command.Parameters.AddWithValue("@Price", record.Price);
                command.Parameters.AddWithValue("@Qty", record.Qty);
                command.Parameters.AddWithValue("@Amount", record.Amount);
                command.Parameters.AddWithValue("@CreateTime", record.CreateTime);
                command.Parameters.AddWithValue("@LastUpdateTime", record.LastUpdateTime);
                command.ExecuteNonQuery();
            }

            transaction.Commit();
            Console.WriteLine("JSON è³‡æ–™å·²æˆåŠŸåŒ¯å…¥");
        }
        catch (Exception ex)
        {
            transaction.Rollback();
            Console.WriteLine($"åŒ¯å…¥å¤±æ•—: {ex.Message}");
            throw;
        }
    }
}

public class CRecord
{
    public int PK1 { get; set; }
    public string SKU { get; set; } = string.Empty;
    public string? Name { get; set; } = null;
    public decimal Price { get; set; }
    public int Qty { get; set; }
    public decimal Amount { get; set; }
    public DateTime CreateTime { get; set; } = DateTime.MinValue;
    public DateTime LastUpdateTime { get; set; } = DateTime.MinValue;
}

public class Program
{
    public static void Main()
    {
        var dbHandler = new DatabaseHandler();

        // åŒ¯å‡º JSON
        dbHandler.ExportJson("tlab3_export.json");

        // åŒ¯å…¥ JSON
        dbHandler.ImportJson("tlab3_import.json");
    }
}
```

### **ç¨‹å¼èªªæ˜**
1. **`ExportJson()` å‡½æ•¸**ï¼š
   - å¾ `tlab3` è¡¨æ ¼è®€å–è³‡æ–™ï¼Œå°‡å…¶è½‰æ›ç‚º `CRecord` çš„é›†åˆï¼Œä¸¦åºåˆ—åŒ–ç‚º JSON æ ¼å¼ã€‚
   - ä½¿ç”¨ `JsonSerializer` å¯«å…¥ UTF-8 çš„ JSON æª”æ¡ˆã€‚

2. **`ImportJson()` å‡½æ•¸**ï¼š
   - è®€å– JSON æª”æ¡ˆä¸¦å°‡å…¶ååºåˆ—åŒ–ç‚º `CRecord` é›†åˆã€‚
   - ä½¿ç”¨ `ON DUPLICATE KEY UPDATE` ç¢ºä¿åŒ¯å…¥æ™‚ï¼Œè‹¥ä¸»éµé‡è¤‡å‰‡æ›´æ–°è³‡æ–™ã€‚

3. **JSON æ–‡ä»¶æ ¼å¼**ï¼š
   - JSON æ–‡ä»¶åŒ…å«æ¯ä¸€ç­†ç´€éŒ„çš„å±¬æ€§ï¼Œä¾‹å¦‚ï¼š
     ```json
     [
         {
             "PK1": 1,
             "SKU": "SKU001",
             "Name": "Item 1",
             "Price": 100.0,
             "Qty": 2,
             "Amount": 200.0,
             "CreateTime": "2025-04-29T11:33:00",
             "LastUpdateTime": "2025-04-29T11:33:00"
         }
     ]
     ```

4. **ç•°å¸¸è™•ç†**ï¼š
   - åŒ¯å…¥éç¨‹ä¸­ä½¿ç”¨äº¤æ˜“ (`Transaction`) ç¢ºä¿è³‡æ–™å®Œæ•´æ€§ï¼Œè‹¥é‡åˆ°éŒ¯èª¤å‰‡å›æ»¾ã€‚

### **ä½¿ç”¨å»ºè­°**
- ç¢ºä¿ `connectionString` æ˜¯æ­£ç¢ºçš„ï¼Œä¸¦å…·æœ‰è¨ªå•è³‡æ–™åº«çš„æ¬Šé™ã€‚
- åŒ¯å…¥ JSON æ™‚ï¼Œç¢ºä¿æ–‡ä»¶å…§å®¹çš„çµæ§‹èˆ‡ `CRecord` é¡åˆ¥ä¸€è‡´ã€‚

å¦‚æœéœ€è¦æ›´é€²ä¸€æ­¥çš„åŠŸèƒ½æˆ–æ“´å……ï¼Œéš¨æ™‚å‘Šè¨´æˆ‘ï¼ ğŸ˜Š